this.RevenueHero=(()=>{function h(e,{defaultLocale:t}){switch(t??e){case"ar":case"ar-AE":case"ar-BH":case"ar-DZ":case"ar-EG":case"ar-IQ":case"ar-JO":case"ar-KW":case"ar-LB":case"ar-LY":case"ar-MA":case"ar-OM":case"ar-QA":case"ar-SA":case"ar-SD":case"ar-SY":case"ar-TN":case"ar-YE":return"ar";case"cs":case"cs-CZ":return"cs";case"da":case"da-DK":return"da";case"de":case"de-AT":case"de-CH":case"de-DE":case"de-LI":case"de-LU":return"de";case"el":case"el-CY":case"el-GR":return"el";case"en-029":case"en-AU":case"en-BZ":case"en-cb":case"en-GB":case"en-IE":case"en-IN":case"en-JM":case"en-MT":case"en-MY":case"en-NZ":case"en-PH":case"en-SG":case"en-TT":case"en-ZA":case"en-ZW":return"en-GB";case"en":case"en-CA":case"en-US":return"en-US";case"es-AR":case"es-BO":case"es-CL":case"es-CO":case"es-CR":case"es-DO":case"es-EC":case"es-GT":case"es-HN":case"es-MX":case"es-NI":case"es-PA":case"es-PE":case"es-PR":case"es-PY":case"es-SV":case"es-US":case"es-UY":case"es-VE":return"es-419";case"es":case"es-ES":case"eu-ES":return"es-ES";case"fi":case"fi-FI":return"fi";case"fr-CA":return"fr-CA";case"fr":case"fr-BE":case"fr-CH":case"fr-FR":case"fr-LU":case"fr-MC":return"fr";case"he":case"he-IL":return"he";case"hu":case"hu-HU":return"hu";case"id":case"id-ID":return"id";case"it":case"it-CH":case"it-IT":return"it";case"ja":case"ja-JP":return"ja";case"ko":case"ko-KR":return"ko";case"nl":case"nl-BE":case"nl-NL":return"nl";case"no":case"nn-NO":case"no-no":return"no";case"pl":case"pl-PL":return"pl";case"pt-BR":return"pt-BR";case"pt-PT":return"pt-PT";case"ro":case"ro-mo":case"ro-RO":return"ro";case"ru":case"ru-mo":case"ru-RU":return"ru";case"sv":case"sv-FI":case"sv-SE":return"sv-SE";case"tr":case"tr-TR":return"tr";case"vi":case"vi-VN":return"vi";case"zh-MO":case"zh-SG":case"zh-CN":return"zh-CN";case"zh-HK":return"zh-HK";case"zh-TW":return"zh-TW"}return"en-US"}let r=["PAGE_LOADED","RESIZE_IFRAME","CLICKED_POWERED_BY","START_REDIRECT_TIMER","CLOSE_DIALOG","RESCHEDULE_CLICKED","ADDING_GUEST","ADDED_GUEST","CLOSE_ADD_GUEST","MEETING_ALREADY_BOOKED","MEETING_BOOKED","MEETING_RESCHEDULED","INIT_REDIRECT","CREATE_RELAY_SESSION","DAY_CHANGED","SELECTED_LOCATION","RH_PARENT_FOCUSED","RH_SUBMITTING_SESSION","RH_HIDE_LOADER","RH_FORM_SUBMITTED","PROSPECT_DISQUALIFIED","hsFormCallback"];function m(e,t,s){fetch("https://app.revenuehero.io/logs/ingest",{method:"POST",mode:"cors",keepalive:!0,headers:{"Content-Type":"application/octet-stream","X-No-Compression":"1"},body:JSON.stringify([{url:location.href,runtime:window.navigator.userAgent,time:Date.now(),level:"info",message:e,sessionId:s,args:t}])})}let o="RH_SUBMITTING_SESSION",a="RH_HIDE_LOADER",n=h(navigator.language,{});class c{sessionId;url;routerId;formId;constructor(e,t){this.sessionId=t,this.routerId=e,this.url="https://app.revenuehero.io",this.formId=null}setFormId(e){this.formId=e}async createSession(s){let e={include:"account,form_router,meeting_type.locations","fields[form_session]":"session_id,meeting_slots,booking_date,time_zone,qualified,redirect_url,next_available_dates,redistribution_redirect","fields[account]":"company,email_domain,image_url,scheduler_colors,whitelabel,widget_redirect_timeout,widget_hour12_format","fields[form_router]":"redistribution_timeout","fields[meeting_type]":"duration,greeting_text,description,booking_days_limit,day_visibility,show_weekends,widget_hour12_format,locations,location_position,location_greeting_text,location_mode","fields[location]":"name,icon,description"};window.postMessage({type:o,formId:this.formId},"*");try{let t=await fetch(this.url+"/api/sessions/create?"+new URLSearchParams(e).toString(),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({form_session:{...s,session_id:this.sessionId,form_router_id:this.routerId,source_url:window.location.href},locale:n})});if(!t.ok){if(416===t.status){let e=await t.json();return m("marketing__form-submit--errored",{formId:this.formId,routerId:this.routerId,status:t.status,qualified:e.data.attributes.qualified},this.sessionId),{...e,noSlotsAvailable:!0}}let e=await t.text();throw m("marketing__form-submit--errored",{formId:this.formId,routerId:this.routerId,status:t.status,statusText:t.statusText,error:e,fieldCount:Object.keys(s.form_params).length},this.sessionId),console.error(`RevenueHero form submission failed (${t.status}). Please contact support@revenuehero.io if this persists.`),new Error(`API request failed: ${t.status} `+t.statusText)}var i=await t.json(),r=i.data.attributes.qualified;if(m("marketing__form-session--submitted",{formId:this.formId,routerId:this.routerId,qualified:r,redirectUrl:i.data.attributes.redirect_url,fieldCount:Object.keys(s.form_params).length},this.sessionId),r)return i;{window.postMessage({type:"PROSPECT_DISQUALIFIED"},"*");let e=i.data.attributes.redirect_url;return null!=e&&""!==e.trim()&&(window.location.href=e),window.postMessage({type:a},"*"),null}}catch(s){throw m("marketing__form-submit--errored",{formId:this.formId,routerId:this.routerId,error:s instanceof Error?s.message:String(s),type:s instanceof Error?s.name:"UnknownError"},this.sessionId),console.error("RevenueHero form submission failed. Please contact support@revenuehero.io if this persists.",s),s}}}let l="RH_EMBED_TARGET",i="RH_DATA_SOURCE",d="RH_SESSION_ID",u="RH_ROUTER_ID",f="RH_FORM_ID",p="RH_SHOW_LOADER",g="RH_FORM_SUBMITTED";class t{storage;constructor(){this.storage=window.localStorage}set(e,t){this.storage.setItem(e,JSON.stringify(t))}get(e){var t=this.storage.getItem(e);return null===t?null:(t=JSON.parse(t),this.storage.removeItem(e),t)}}class I extends t{sessionId;routerId;constructor(e){super(),this.sessionId=e.sessionId,this.routerId=e.routerId}loadData(){var e=this.get(d);return null!==e?this.get(e):null}setData(t,e){var s=this.get("RH_SESSION_ID");if(this.set(i,e),this.set(u,this.routerId),null===s)this.set(d,this.sessionId),this.set(this.sessionId,t);else{let e=this.get(s);null!==e&&(this.set(d,s),this.set(s,{...e,...t}))}}}class e{api;dialog;timeZone;embedTarget;constructor(e,t){this.api=e,this.dialog=t,this.timeZone=(()=>{var e=window.Intl.DateTimeFormat().resolvedOptions().timeZone;switch(e.toLowerCase()){case"etc/unknown":case"+00:00":return"UTC";default:return e}})()}showDialog(e){null!==e&&this.dialog.open(e)}}class E extends e{store;insideIFrame;formId;constructor(e,t,s,i){super(t,s),this.formId=e,this.store=i,this.insideIFrame=window!==window.parent}async handleSubmit(){var e,t=document.querySelector(this.formId);null!==t&&(e=t.querySelectorAll("input"),t=t.querySelectorAll("select"),e=[...e].reduce((e,t)=>(e[t.name]=t.value,e),{}),e=[...t].reduce((e,t)=>(e[t.name]=t.options[t.selectedIndex].innerText,e),e),this.store.setData(e,"pardot"))}async handleMessage(e){var t;void 0!==e?.data&&"pardot"===e.data.source&&e.data.type===g&&null!==(t=e.data.formData)&&(m("marketing__form--submitted",{formId:this.formId,eventData:e.data,formData:t},this.api.sessionId),e=await this.api.createSession({time_zone:this.timeZone,form_params:t}),this.showDialog(e))}addEventListener(){var e=document.querySelector(this.formId);null!==e&&(m("marketing__form-schedule--attached",{formId:this.formId},this.api.sessionId),e.addEventListener("submit",this.handleSubmit.bind(this))),this.insideIFrame||window.addEventListener("message",async e=>{await this.handleMessage(e)})}static pageValid(e){return null===e.querySelector(".error")}}class b{greetingText;descriptionText;locale;embedTarget;url;dialogOpen;redirectUrl;dialogElement;dialogContent;iframeElement;events;data;formRouter;account;timeout;meetingBooked;showLoader;formId;loaderColor;requireConfirmation=!1;sessionId;noSlotsAvailable=!1;constructor({greetingText:e,descriptionText:t,locale:s,showLoader:i=!1,loaderColor:r="#fff",embedTarget:o,requireConfirmation:a=!1,sessionId:n}){this.greetingText=e,this.locale=s,this.events=[],this.meetingBooked=!1,this.showLoader=i,this.loaderColor=r,this.descriptionText=t,this.requireConfirmation=a,this.sessionId=n,void 0!==o&&this.setEmbedTarget(o),this.addEventListeners()}setEmbedTarget(e){this.embedTarget=document.querySelector(e),null===this.embedTarget?console.warn("RevenueHero - embed target not found"):(this.embedTarget.style.position="relative",this.dialogElement?.remove())}setFormId(e){this.formId=e}redirect(){null!=this.redirectUrl&&""!==this.redirectUrl.trim()&&(window.location.href=this.redirectUrl)}open(e){(()=>{var e=navigator.userAgent;let t,s,i,r=parseFloat(navigator.appVersion).toString(),o=parseInt(navigator.appVersion,10),a=navigator.appName;return-1!==(t=e.indexOf("OPR"))?(a="Opera",r=e.substring(t+4),-1!==(t=e.indexOf("Version"))&&(r=e.substring(t+8))):-1!==(t=e.indexOf("Edg"))?(a="Microsoft Edge",r=e.substring(t+4)):-1!==(t=e.indexOf("MSIE"))?(a="Microsoft Internet Explorer",r=e.substring(t+5)):-1!==(t=e.indexOf("Chrome"))?(a="Chrome",r=e.substring(t+7)):-1!==(t=e.indexOf("Safari"))?(a="Safari",r=e.substring(t+7),-1!==(t=e.indexOf("Version"))&&(r=e.substring(t+8))):-1!==(t=e.indexOf("Firefox"))?(a="Firefox",r=e.substring(t+8)):(s=e.lastIndexOf(" ")+1)<(t=e.lastIndexOf("/"))&&(a=e.substring(s,t),r=e.substring(t+1),a.toLowerCase()===a.toUpperCase())&&(a=navigator.appName),-1!==(i=(r=-1!==(i=r.indexOf(";"))?r.substring(0,i):r).indexOf(" "))&&(r=r.substring(0,i)),o=parseInt(""+r,10),isNaN(o)&&(r=parseFloat(navigator.appVersion).toString(),o=parseInt(navigator.appVersion,10)),"Safari"!==a||15<=o})()?(this.noSlotsAvailable=!0===e.noSlotsAvailable,this.data=e,this.data.included=this.data.included.reduce((e,t)=>("meeting_type"===t.type&&(t.attributes.greeting_text=this.greetingText??t.attributes.greeting_text,t.attributes.description=this.descriptionText??t.attributes.description),[...e,t]),[]),this.formRouter=e.included.find(e=>"form_router"===e.type),this.account=e.included.find(e=>"account"===e.type),this.url=this.generateUrlFor(e),this.redirectUrl=this.data.data.attributes.redistribution_redirect,null!=this.embedTarget?this.embedTarget.appendChild(this.createDialogContent()):void 0===this.dialogElement?(this.dialogElement=this.createDialog(),this.dialogElement.appendChild(this.createDialogContent()),document.body.appendChild(this.dialogElement)):this.dialogElement.replaceChildren(this.createDialogContent()),this.addIframeEventListeners(),this.addFocusListener(),this.dialogOpen=!0,m("marketing__scheduler--opened",{embedTarget:this.embedTarget?"embedded":"modal",locale:this.locale,formId:this.formId},this.sessionId)):this.redirect()}close(){try{this.dialogElement?.remove(),this.dialogElement=void 0,this.removeLoader(),this.dialogOpen=!1}catch(e){console.error(e)}finally{this.cleanup()}}addIframeEventListeners(){window.addEventListener("message",(e=>{["PAGE_LOADED"].includes(e.data.type)&&null!==this.iframeElement.contentWindow?(m("marketing__scheduler--loaded",{eventType:e.data.type,isEmbed:void 0!==this.embedTarget},this.sessionId),this.iframeElement.contentWindow.postMessage({isEmbed:void 0!==this.embedTarget,isPopup:!0},"*"),this.isLoading()&&this.removeLoader(),null!==this.formRouter.attributes.redistribution_timeout&&null!==this.data.data.attributes.redistribution_redirect&&null==this.timeout&&(this.timeout=this.setupRedirect(6e4*this.formRouter.attributes.redistribution_timeout))):["RESIZE_IFRAME"].includes(e.data.type)&&null!==this.dialogContent&&void 0===this.embedTarget?this.dialogContent.style.height=e.data.height+"px":["CLICKED_POWERED_BY"].includes(e.data.type)&&window.open(e.data.url,"_blank")}).bind(this))}addEventListeners(){this.addEvent({eventName:"keydown",callback:this.handleKeyDown.bind(this)}),this.addEvent({eventName:"message",callback:this.handleMessage.bind(this)},window)}addEvent(e,t=document){t.addEventListener(e.eventName,e.callback),this.events.push(e)}handleKeyDown(e){"Escape"===e.key&&this.dialogOpen&&close()}addFocusListener(){this.addEvent({eventName:"visibilitychange",callback:()=>{"visible"===document.visibilityState&&this.iframeElement?.contentWindow?.postMessage({type:"RH_PARENT_FOCUSED"},"*")}})}setupRedirect(e=15e3){return setTimeout(()=>{this.close(),this.redirect()},e)}handleMessage(e){var t;["START_REDIRECT_TIMER"].includes(e.data.type)?(null!==this.timeout&&clearTimeout(this.timeout),this.meetingBooked=!0,this.redirectUrl=this.data.data.attributes.redirect_url,this.timeout=this.setupRedirect(e.data.timeout)):"CLOSE_DIALOG"===e.data.type?(null!==this.timeout&&clearTimeout(this.timeout),this.meetingBooked&&(this.redirectUrl=this.data.data.attributes.redirect_url),this.setupRedirect(0)):["RESCHEDULE_CLICKED","ADDING_GUEST"].includes(e.data.type)?(null!==this.timeout&&clearTimeout(this.timeout),this.timeout=null):["ADDED_GUEST"].includes(e.data.type)?(t=e.data.secondsRemaining,this.timeout=this.setupRedirect(1e3*t)):[o].includes(e.data.type)?this.formId===e.data.formId&&this.showLoader&&(this.close(),null!=this.embedTarget?this.embedTarget.appendChild(this.createLoader()):(this.dialogElement=this.createDialog(),this.dialogElement.appendChild(this.createLoader()),document.body.appendChild(this.dialogElement))):[a].includes(e.data.type)?this.showLoader&&this.close():["MEETING_ALREADY_BOOKED"].includes(e.data.type)&&this.setupRedirect(0)}cleanup(){this.events.forEach(e=>{document.removeEventListener(e.eventName,e.callback)})}generateUrlFor(e){var t=new URL("https://popup.schedulehero.io");return`${t.protocol}//${t.host}/${this.locale}/book/meetings/${this.requireConfirmation?"new-with-confirm":"new"}?session_id=`+e.data.attributes.session_id}createDialog(){var e=document.createElement("div");return e.setAttribute("id","rh-dialog"),e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.position="fixed",e.style.left="0px",e.style.zIndex="9999999",e.style.top="0px",e.style.overflow="hidden",e.style.backgroundColor="rgba(0, 0, 0, 0.8)",e.style.backdropFilter="blur(2px)",e.style.width=window.innerWidth+"px",e.style.width="100%",e.style.height="100%",e}createIframe(){return this.iframeElement=document.createElement("iframe"),this.iframeElement.style.border="0",this.iframeElement.style.height="100%",this.iframeElement.style.width="1px",this.iframeElement.style.minWidth="100%",this.iframeElement.style.flexGrow="1",this.iframeElement.src=this.noSlotsAvailable?this.url:this.url+"#"+btoa(encodeURIComponent(JSON.stringify(this.data))),this.iframeElement.id="rh-scheduler-iframe",this.iframeElement}createDialogContent(){var e=void 0===this.account.attributes.scheduler_colors?"8px":this.account.attributes.scheduler_colors.containerBorderRadius??"6px";return this.dialogContent=document.createElement("div"),void 0!==this.embedTarget?(this.dialogContent.style.position="absolute",this.dialogContent.style.top="0px",this.dialogContent.style.bottom="0px",this.dialogContent.style.left="0px",this.dialogContent.style.right="0px",this.dialogContent.style.width="100%",this.dialogContent.style.maxWidth="100%",this.dialogContent.style.height="100%",this.dialogContent.style.maxHeight="100%",this.dialogContent.style.margin="0",this.dialogContent.style.border="0",this.dialogContent.style.borderRadius=e,this.dialogContent.style.overflow="unset",this.dialogContent.style.display="flex",this.dialogContent.style.flexDirection="column",this.dialogContent.style.flexGrow="1"):(this.dialogContent.style.position="relative",this.dialogContent.style.width=window.innerWidth-40+"px",this.dialogContent.style.maxWidth="600px",this.dialogContent.style.height="700px",this.dialogContent.style.maxHeight=window.innerHeight-40+"px",this.dialogContent.style.margin="20px auto",this.dialogContent.style.border="1px solid #888",this.dialogContent.style.borderRadius=e,this.dialogContent.style.overflow="hidden"),this.dialogContent.style.backgroundColor="#fefefe",this.dialogContent.appendChild(this.createIframe()),this.dialogContent}appendLoaderStyles(){var e=document.createElement("style");e.innerHTML=`
      @keyframes l20-1{
        0%    {clip-path: polygon(50% 50%,0       0,  50%   0%,  50%    0%, 50%    0%, 50%    0%, 50%    0% )}
        12.5% {clip-path: polygon(50% 50%,0       0,  50%   0%,  100%   0%, 100%   0%, 100%   0%, 100%   0% )}
        25%   {clip-path: polygon(50% 50%,0       0,  50%   0%,  100%   0%, 100% 100%, 100% 100%, 100% 100% )}
        50%   {clip-path: polygon(50% 50%,0       0,  50%   0%,  100%   0%, 100% 100%, 50%  100%, 0%   100% )}
        62.5% {clip-path: polygon(50% 50%,100%    0, 100%   0%,  100%   0%, 100% 100%, 50%  100%, 0%   100% )}
        75%   {clip-path: polygon(50% 50%,100% 100%, 100% 100%,  100% 100%, 100% 100%, 50%  100%, 0%   100% )}
        100%  {clip-path: polygon(50% 50%,50%  100%,  50% 100%,   50% 100%,  50% 100%, 50%  100%, 0%   100% )}
      }

      @keyframes l20-2{
        0%    {transform:scaleY(1)  rotate(0deg)}
        49.99%{transform:scaleY(1)  rotate(135deg)}
        50%   {transform:scaleY(-1) rotate(0deg)}
        100%  {transform:scaleY(-1) rotate(-135deg)}
      }

      .loader {
        width: 32px;
        aspect-ratio: 1;
        border-radius: 50%;
        border: 4px solid ${this.loaderColor};
        animation:
          l20-1 0.8s infinite linear alternate,
          l20-2 1.6s infinite linear;
        position: absolute;
        top: 50%;
        left: 50%;
        bottom: 50%;
        right: 50%;
      }
  `,document.head.appendChild(e)}isLoading(){return this.showLoader&&null!==document.querySelector(".loader")}createLoader(){var e=document.createElement("div");return e.classList.add("loader"),e}removeLoader(){var e=document.querySelectorAll(".loader");null!==e&&e.forEach(e=>{e.remove()})}}class _ extends e{form;constructor(e,t){super(e,t),this.form=document.querySelector(".wpcf7")}async handleSubmit(e){var e=[...e.detail.formData],t=e.reduce((e,t)=>(e[t[0]]=t[1],e),{}),e=(m("marketing__form--submitted",{formId:this.form?.id||"wpcf7",source:"contact7",fieldCount:e.length},this.api.sessionId),await this.api.createSession({time_zone:this.timeZone,form_params:t}));return this.showDialog(e),!1}addEventListener(){null!==this.form&&m("marketing__form-schedule--attached",{formElement:this.form?.id||"wpcf7"},this.api.sessionId),this.form.addEventListener("wpcf7submit",this.handleSubmit.bind(this),!1)}}class y extends e{formId;submitted;constructor(e,t,s){super(t,s),this.formId=e,this.submitted=!1}async handleSubmit(e){var t,s;e.preventDefault(),this.submitted||(this.submitted=!0,t=Object.fromEntries(new FormData(e.target).entries()),m("marketing__form--submitted",{formId:this.formId,source:"generic",fieldCount:Object.keys(t).length},this.api.sessionId),s=await this.api.createSession({time_zone:this.timeZone,form_params:t}),this.showDialog(s),await this.sendOriginalAction(e.target,t))}async sendOriginalAction(e,t){void 0!==e.action&&await fetch(e.action,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})}addEventListener(){var e=document.querySelector(this.formId);null!==e&&(m("marketing__form-schedule--attached",{formId:this.formId},this.api.sessionId),e.addEventListener("submit",this.handleSubmit.bind(this)))}}let w='.hbspt-form, .hs-form, [data-hs-forms-root="true"]';class v extends e{formData;formElement;formId;constructor(e,t,s){super(t,s),this.formId=e.startsWith("#")?e.slice(1):e,this.formElement=null,this.formData=null}addEventListener(){window.addEventListener("hs-form-event:on-submission:success",this.handleV4Submit.bind(this)),window.addEventListener("message",this.handleSubmit.bind(this))}async handleSubmit(t){if(void 0!==t.data&&this.formId.includes(t.data.id)&&"hsFormCallback"===t.data.type&&("onFormSubmit"===t.data.eventName&&(null!=(r=[...document.querySelectorAll(".hbspt-form > iframe")].find(e=>null!==(e.contentDocument?.querySelector(`[id*=${this.formId}]`)??e.contentDocument?.querySelector(`[data-form-id*=${this.formId}]`))))?this.formElement=r.contentDocument?.querySelector("form"):(this.formElement=document.querySelector(`[id*=${this.formId}]`)??document.querySelector(`[data-form-id*=${this.formId}]`)??document.querySelector(w),null!==this.formElement&&(this.formElement="FORM"!==this.formElement.nodeName?this.formElement.querySelector("form"):this.formElement)),this.formData=Array.isArray(t.data.data)?t.data.data.reduce((e,t)=>(e[t.name]=t.value,e),{}):{...t.data.data}),"onFormSubmitted"===t.data.eventName)){let s=null!=this.formElement?Object.fromEntries(Object.entries(Object.fromEntries(new FormData(this.formElement))).filter(e=>""!==e[1]&&null!=e[1])):{},i=this.formData??{},e=[...new Set([...Object.keys(s),...Object.keys(i)])].reduce((e,t)=>(e[t]=(null!=s[t]&&""!==s[t]&&typeof i[t]==typeof s[t]?s:i)[t],e),{});m("marketing__form--submitted",{formId:this.formId,hubspotFormId:t.data.id,eventName:t.data.eventName,fieldCount:Object.keys(e).length},this.api.sessionId);var r=await this.api.createSession({form_params:e,time_zone:this.timeZone});this.showDialog(r)}}async handleV4Submit(e){try{var t,s,i,r=window.HubSpotFormsV4.getFormFromEvent(e);null==r?m("marketing__form-schedule--no-form-found",{reason:"no-form-from-event",source:"hubspot-v4"},this.api.sessionId):(t=r.getFormId(),this.formId.includes(t)?(s=await r.getFormFieldValues(),this.formData=this.convertV4FormValues(s),m("marketing__form--submitted",{formId:this.formId,hubspotFormId:t,fieldCount:s.length},this.api.sessionId),i=await this.api.createSession({form_params:this.formData,time_zone:this.timeZone}),this.showDialog(i)):m("marketing__form-schedule--no-form-found",{reason:"form-id-mismatch",source:"hubspot-v4",expectedFormId:this.formId,actualFormId:t},this.api.sessionId))}catch(e){console.error("Error in RevenueHero HubSpot V4 handler:",e)}}convertV4FormValues(e){return e.reduce((e,t)=>(e[t.name]=t.value,e),{})}}let s="inline-form";class S extends e{data;constructor(e,t,s){super(e,t),this.data=s}async submit(){return window.postMessage({type:o,formId:s},"*"),this.api.createSession({time_zone:this.timeZone,form_params:this.data})}}class C extends e{formId;JotForm=null;constructor(e,t,s){super(t,s),this.formId=e}isValidJotForm(e){return!0===this.JotForm?.validateAll(e)}async handleSubmit(e){var e=e.target??e.submitter?.form;this.isValidJotForm(e)&&(e=Object.fromEntries(new FormData(e)),m("marketing__form--submitted",{formId:this.formId,source:"jotform",fieldCount:Object.keys(e).length},this.api.sessionId),e=await this.api.createSession({time_zone:this.timeZone,form_params:e}),this.showDialog(e))}addEventListener(){new Promise(e=>setTimeout(e,3e3)).then(()=>{var e,t=document.querySelector(this.formId);null!==t&&null!==(e=t.contentDocument)&&(e=e.querySelector("form"),this.JotForm=t.contentWindow?.JotForm??null,null!==e)&&(m("marketing__form-schedule--attached",{formId:this.formId},this.api.sessionId),e.addEventListener("submit",this.handleSubmit.bind(this)))}).catch(e=>{console.error(e)})}}class T extends e{form;constructor(e,t,s){super(t,s);t=e.split("_")[1];this.form=window.MktoForms2.getForm(t)}async handleSubmit(e){m("marketing__form--submitted",{formId:this.form?.getId?.()||"marketo-form",source:"marketo",fieldCount:Object.keys(e).length},this.api.sessionId);e=await this.api.createSession({time_zone:this.timeZone,form_params:e});return this.showDialog(e),!1}addEventListener(){null!=this.form&&m("marketing__form-schedule--attached",{formId:this.form?.getId?.()||"marketo-form"},this.api.sessionId),this.form.onSuccess(e=>(this.handleSubmit(e).then(()=>{console.log("success")}).catch(e=>{console.error(e)}),!1))}}let D=window.parent!==window;class L{api;dialog;embedTarget;static formsConnected=[];formType;locale;showLoader;sessionId;store;constructor(e){var{descriptionText:t,embedTarget:s,formType:i,greetingText:r,loaderColor:o,locale:a,requireConfirmation:n=!1,routerId:d,showLoader:l=!0}=e;this.sessionId=this.generateNewSessionId(),m("marketing--init",{...e},this.sessionId),this.api=new c(d,this.sessionId),this.store=new I(this.api),this.locale=h(navigator.language,{defaultLocale:a}),this.dialog=new b({descriptionText:t,embedTarget:s,greetingText:r,loaderColor:o,locale:this.locale,requireConfirmation:n,showLoader:l,sessionId:this.sessionId}),this.formType=i,this.showLoader=l,this.store.set(p,this.showLoader),this.addWebHints(),this.dialog.appendLoaderStyles()}generateNewSessionId(){return crypto.randomUUID()}updateSessionId(){this.sessionId=this.generateNewSessionId(),this.api.sessionId=this.sessionId,this.dialog.sessionId=this.sessionId}addWebHints(){var e=document.createElement("link"),t=(e.rel="preconnect",new URL("https://popup.schedulehero.io"));e.href=t.origin,document.head.appendChild(e)}asyncSchedule(s,i){if(!L.formsConnected.includes(s)){m("marketing__form-schedule--init",{routerId:this.api.routerId},this.sessionId),this.addEventListeners(),L.formsConnected.push(s),this.dialog.setFormId(s),this.api.setFormId(s),this.store.set(f,s),void 0!==i&&(this.store.set(l,i),this.dialog.setEmbedTarget(i));var i="hubspot"===this.formType||void 0!==window.HubSpotFormsV4||void 0!==window.hbspt&&void 0!==window.hbspt.forms||s.includes("hsForm")||s.includes("hbspt")||null!==document.querySelector(w),r=void 0!==window.MktoForms2&&void 0!==window.MktoForms2.allForms&&window.MktoForms2.allForms().some(e=>{var t=e.getFormElem?.()?.[0];if(t){let e=t.getAttribute("id");return e&&(s===e||s.includes(e)||e.includes(s))}return!1}),o=void 0!==window.wpcf7,a="pardot"===this.formType,n="jotForm"===this.formType;let e,t;m("marketing__form--detected",{formType:t=i?(e=new v(s,this.api,this.dialog),"hubspot"):r?(e=new T(s,this.api,this.dialog),"marketo"):o?(e=new _(this.api,this.dialog),"contact7"):a?(e=new E(s,this.api,this.dialog,this.store),"pardot"):n?(e=new C(s,this.api,this.dialog),"jotform"):(e=new y(s,this.api,this.dialog),"generic"),formId:s,routerId:this.api.routerId},this.sessionId),i?e.addEventListener():(this.scheduleFormElementCheck(s),(async i=>new Promise(s=>{var e=document.querySelector(i);if(null!==e)s(e);else{let t=new MutationObserver(()=>{var e=document.querySelector(i);null!==e&&(s(e),t.disconnect())});t.observe(document.body,{childList:!0,subtree:!0})}}))(s).then(()=>{e.addEventListener()}).catch(e=>{console.error(e)}))}}schedule(e,t){"complete"===document.readyState?this.asyncSchedule(e,t):window.addEventListener("load",()=>{this.asyncSchedule(e,t)})}addEventListeners(){window.addEventListener("message",t=>{"PAGE_LOADED"===t.data?.type&&this.updateSessionId();var s=this.sessionId;if(null!=t.data&&null!=t.data.type){var e=r.includes(t.data.type),i="pardot"===t.data.source&&"RH_FORM_SUBMITTED"===t.data.type;if(e||i){let e={type:t.data.type};t.data.source&&(e.source=t.data.source),"hsFormCallback"===t.data.type?(t.data.eventName&&(e.eventName=t.data.eventName),t.data.id&&(e.formId=t.data.id)):e.payload=t.data,m("marketing__message--received",e,s)}}})}scheduleFormElementCheck(t){setTimeout(()=>{null===(document.querySelector(t)??[...document.querySelectorAll("iframe")].map(e=>e.contentDocument?.querySelector(t)??null).find(e=>e instanceof HTMLElement)??null)&&m("marketing__form-schedule--no-form-found",{formId:t,routerId:this.api.routerId},this.sessionId)},1e4)}async submit(e){try{this.addEventListeners();var t=new S(this.api,this.dialog,e);return this.api.setFormId(s),this.dialog.setFormId(s),m("marketing__form--detected",{formType:"inline",formId:s,routerId:this.api.routerId},this.sessionId),m("marketing__form--submitted",{routerId:this.api.routerId},this.sessionId),await t.submit()}catch(e){return m("marketing__form-submit--errored",{error:JSON.stringify(e)},this.sessionId),null}}}{let o=new t,r=o.get(i),e=o.get(u),s=o.get(l),a=o.get(f)||"",n=o.get(p)||!1,d=(e,t)=>{null!==t&&(null!==s&&e.dialog.setEmbedTarget(s),e.dialog.open(t))};if(null!==e){let t=new L({routerId:e,showLoader:n}),s=t.store.loadData(),i=(t,e)=>{t.submit(e).then(e=>{d(t,e)}).catch(e=>{console.error(e)})};if(D&&"pardot"===r&&null!==s&&E.pageValid(document))window.parent.postMessage({formData:s,routerId:e,source:"pardot",type:g},"*");else if(!D&&null!==s&&null!==r){let e=(()=>{if("pardot"===r)return E})();new Promise(e=>setTimeout(e,100)).then(()=>{e.pageValid(document)&&i(t,s)}).catch(e=>{console.error(e)})}}window.addEventListener("message",async i=>{if(void 0!==i?.data&&i.data.type===g){let e=o.get(p)||!1,t=new L({routerId:i.data.routerId,showLoader:e}),s=e=>{d(t,e)};t.api.setFormId(a),t.dialog.setFormId(a);var r=new E("",t.api,t.dialog,t.store);r.showDialog=s,await r.handleMessage(i)}})}return L})();